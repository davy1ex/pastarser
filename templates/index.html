{% extends "base.html" %}

{% block css %}
	<link rel="stylesheet" type="text/css" href="{{ url_for ("static", filename="css/index.css") }} ">
{% endblock %}

{% block content %}
	<script>
		if (!Notification.permission == "granted") {
			Notification.requestPermission();
		}
		else {
			var notification = new Notification("хуй");
		}
	</script>
	<div class="menu">
		<ul>
			<li>
				<a href="{{ url_for("sort_by_relevance", page=page) }}">sort by relevance</a>
			</li>
			<li>
				<a href="{{ url_for("index", page=page) }}">sort by new</a>
			</li>
		</ul>
	</div>
	<div class="posts_wrapper">
		{% for post in posts %}
			{% if post.text | length > 300 and post.marked_as_ads == 0 %}
				<div class="post_wrapper">
					<div class="post">
						{% if "attachments" in post.keys() %}
							{% for attachment in post.attachments %}
						    	{% if attachment.type == "photo" %}
						    		<div class="img">
						    			<img src="{{ attachment.photo.sizes[-1].url }}"></a>
						    		</div>						
								{% endif %}
							{% endfor %}
						{% endif %}
						
						{% if post.text | length > 180 %}
							{{ post.text[:180]}}... 
							<a href="{{ url_for("post", id=post.id) }}">&gt;&gt;&gt;</a>
						{% else %}
							{{ post.text }}
						{% endif %}
						<br>
						<div class="likes">
							likes: {{ post.likes.count }}
						</div>
					</div>
				</div>				
			{% endif %}
		{% endfor %}
	</div>
	<div class="pages_nav">		
		<ul>
			{% if page != 0 %}
				<li>
					<a href="{{ url_for("index", page=0) }}">0</a> ...
				</li>
			{% endif %}

			{% for n_page in range(9) %}
				<li>
					<a href="{{ url_for("index", page=page+n_page) }}">{{ page + n_page }}</a>
				</li>
			{% endfor %}
		</ul>
	</div>
{% endblock %}